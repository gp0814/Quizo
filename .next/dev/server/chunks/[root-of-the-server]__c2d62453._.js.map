{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Gaurav/Desktop/Quizo/src/lib/auth.ts"],"sourcesContent":["import jwt from 'jsonwebtoken';\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || 'fallback_secret';\r\n\r\nexport function signToken(payload: any) {\r\n    return jwt.sign(payload, JWT_SECRET, { expiresIn: '1d' });\r\n}\r\n\r\nexport function verifyToken(token: string) {\r\n    try {\r\n        return jwt.verify(token, JWT_SECRET);\r\n    } catch (error) {\r\n        return null;\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAEtC,SAAS,UAAU,OAAY;IAClC,OAAO,kJAAG,CAAC,IAAI,CAAC,SAAS,YAAY;QAAE,WAAW;IAAK;AAC3D;AAEO,SAAS,YAAY,KAAa;IACrC,IAAI;QACA,OAAO,kJAAG,CAAC,MAAM,CAAC,OAAO;IAC7B,EAAE,OAAO,OAAO;QACZ,OAAO;IACX;AACJ"}},
    {"offset": {"line": 101, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Gaurav/Desktop/Quizo/src/lib/db.ts"],"sourcesContent":["import mongoose from 'mongoose';\r\n\r\nconst MONGODB_URI = process.env.MONGODB_URI;\r\n\r\nif (!MONGODB_URI) {\r\n    throw new Error(\r\n        'Please define the MONGODB_URI environment variable inside .env.local'\r\n    );\r\n}\r\n\r\n/**\r\n * Global is used here to maintain a cached connection across hot reloads\r\n * in development. This prevents connections growing exponentially\r\n * during API Route usage.\r\n */\r\nlet cached = (global as any).mongoose;\r\n\r\nif (!cached) {\r\n    cached = (global as any).mongoose = { conn: null, promise: null };\r\n}\r\n\r\nasync function dbConnect() {\r\n    if (cached.conn) {\r\n        console.log('Using cached database connection');\r\n        return cached.conn;\r\n    }\r\n\r\n    if (!cached.promise) {\r\n        const opts = {\r\n            bufferCommands: false,\r\n        };\r\n\r\n        console.log('Creating new database connection');\r\n        cached.promise = mongoose.connect(MONGODB_URI!, opts).then((mongoose) => {\r\n            return mongoose;\r\n        });\r\n    }\r\n\r\n    try {\r\n        cached.conn = await cached.promise;\r\n    } catch (e) {\r\n        cached.promise = null;\r\n        throw e;\r\n    }\r\n\r\n    return cached.conn;\r\n}\r\n\r\nexport default dbConnect;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAE3C,IAAI,CAAC,aAAa;IACd,MAAM,IAAI,MACN;AAER;AAEA;;;;CAIC,GACD,IAAI,SAAS,yDAAgB,QAAQ;AAErC,IAAI,CAAC,QAAQ;IACT,SAAS,yDAAgB,QAAQ,GAAG;QAAE,MAAM;QAAM,SAAS;IAAK;AACpE;AAEA,eAAe;IACX,IAAI,OAAO,IAAI,EAAE;QACb,QAAQ,GAAG,CAAC;QACZ,OAAO,OAAO,IAAI;IACtB;IAEA,IAAI,CAAC,OAAO,OAAO,EAAE;QACjB,MAAM,OAAO;YACT,gBAAgB;QACpB;QAEA,QAAQ,GAAG,CAAC;QACZ,OAAO,OAAO,GAAG,oHAAQ,CAAC,OAAO,CAAC,aAAc,MAAM,IAAI,CAAC,CAAC;YACxD,OAAO;QACX;IACJ;IAEA,IAAI;QACA,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IACtC,EAAE,OAAO,GAAG;QACR,OAAO,OAAO,GAAG;QACjB,MAAM;IACV;IAEA,OAAO,OAAO,IAAI;AACtB;uCAEe"}},
    {"offset": {"line": 149, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Gaurav/Desktop/Quizo/src/models/Result.ts"],"sourcesContent":["import mongoose, { Schema, Document, Model } from 'mongoose';\r\n\r\nexport interface IResult extends Document {\r\n    testId: mongoose.Types.ObjectId;\r\n    studentId: mongoose.Types.ObjectId;\r\n    studentName: string;\r\n    usn: string;\r\n    department: string;\r\n    semester: string;\r\n    score: number;\r\n    totalMarks: number;\r\n    answers: {\r\n        questionId?: string; // or index\r\n        questionText: string;\r\n        selectedOption: string;\r\n        isCorrect: boolean;\r\n    }[];\r\n    submittedAt: Date;\r\n}\r\n\r\nconst ResultSchema: Schema<IResult> = new Schema(\r\n    {\r\n        testId: { type: Schema.Types.ObjectId, ref: 'Test', required: true },\r\n        studentId: { type: Schema.Types.ObjectId, ref: 'User', required: true },\r\n        studentName: { type: String, required: true },\r\n        usn: { type: String, required: true },\r\n        department: { type: String, required: true },\r\n        semester: { type: String, required: true },\r\n        score: { type: Number, required: true },\r\n        totalMarks: { type: Number, required: true },\r\n        answers: [{\r\n            questionId: Schema.Types.ObjectId,\r\n            questionText: String,\r\n            selectedOption: String,\r\n            isCorrect: Boolean\r\n        }],\r\n        submittedAt: { type: Date, default: Date.now }\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nconst Result: Model<IResult> = mongoose.models.Result || mongoose.model<IResult>('Result', ResultSchema);\r\nexport default Result;\r\n"],"names":[],"mappings":";;;;AAAA;;AAoBA,MAAM,eAAgC,IAAI,mHAAM,CAC5C;IACI,QAAQ;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAQ,UAAU;IAAK;IACnE,WAAW;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAQ,UAAU;IAAK;IACtE,aAAa;QAAE,MAAM;QAAQ,UAAU;IAAK;IAC5C,KAAK;QAAE,MAAM;QAAQ,UAAU;IAAK;IACpC,YAAY;QAAE,MAAM;QAAQ,UAAU;IAAK;IAC3C,UAAU;QAAE,MAAM;QAAQ,UAAU;IAAK;IACzC,OAAO;QAAE,MAAM;QAAQ,UAAU;IAAK;IACtC,YAAY;QAAE,MAAM;QAAQ,UAAU;IAAK;IAC3C,SAAS;QAAC;YACN,YAAY,mHAAM,CAAC,KAAK,CAAC,QAAQ;YACjC,cAAc;YACd,gBAAgB;YAChB,WAAW;QACf;KAAE;IACF,aAAa;QAAE,MAAM;QAAM,SAAS,KAAK,GAAG;IAAC;AACjD,GACA;IAAE,YAAY;AAAK;AAGvB,MAAM,SAAyB,oHAAQ,CAAC,MAAM,CAAC,MAAM,IAAI,oHAAQ,CAAC,KAAK,CAAU,UAAU;uCAC5E"}},
    {"offset": {"line": 211, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Gaurav/Desktop/Quizo/src/app/api/results/student/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { verifyToken } from '@/lib/auth';\r\nimport dbConnect from '@/lib/db';\r\nimport Result from '@/models/Result';\r\n\r\nasync function getUser(req: Request) {\r\n    const cookieHeader = req.headers.get('cookie');\r\n    const token = cookieHeader?.split(';').find(c => c.trim().startsWith('token='))?.split('=')[1];\r\n    if (!token) return null;\r\n    const decoded: any = verifyToken(token);\r\n    return decoded;\r\n}\r\n\r\nexport async function GET(req: Request) {\r\n    try {\r\n        const userData = await getUser(req);\r\n        if (!userData || userData.role !== 'student') {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        await dbConnect();\r\n        // Populate test title? Result model has testId ref 'Test'.\r\n        const results = await Result.find({ studentId: userData.userId })\r\n            .populate('testId', 'title')\r\n            .sort({ submittedAt: -1 });\r\n\r\n        // Filter out results where the test has been deleted (testId becomes null)\r\n        const validResults = results.filter((r: any) => r.testId);\r\n\r\n        return NextResponse.json({ results: validResults });\r\n    } catch (error) {\r\n        return NextResponse.json({ error: 'Server Error' }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEA,eAAe,QAAQ,GAAY;IAC/B,MAAM,eAAe,IAAI,OAAO,CAAC,GAAG,CAAC;IACrC,MAAM,QAAQ,cAAc,MAAM,KAAK,KAAK,CAAA,IAAK,EAAE,IAAI,GAAG,UAAU,CAAC,YAAY,MAAM,IAAI,CAAC,EAAE;IAC9F,IAAI,CAAC,OAAO,OAAO;IACnB,MAAM,UAAe,IAAA,mIAAW,EAAC;IACjC,OAAO;AACX;AAEO,eAAe,IAAI,GAAY;IAClC,IAAI;QACA,MAAM,WAAW,MAAM,QAAQ;QAC/B,IAAI,CAAC,YAAY,SAAS,IAAI,KAAK,WAAW;YAC1C,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACtE;QAEA,MAAM,IAAA,6HAAS;QACf,2DAA2D;QAC3D,MAAM,UAAU,MAAM,oIAAM,CAAC,IAAI,CAAC;YAAE,WAAW,SAAS,MAAM;QAAC,GAC1D,QAAQ,CAAC,UAAU,SACnB,IAAI,CAAC;YAAE,aAAa,CAAC;QAAE;QAE5B,2EAA2E;QAC3E,MAAM,eAAe,QAAQ,MAAM,CAAC,CAAC,IAAW,EAAE,MAAM;QAExD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAa;IACrD,EAAE,OAAO,OAAO;QACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACtE;AACJ"}}]
}